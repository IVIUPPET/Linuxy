description = [[
finds a webcam]]

categories = {"safe", "discovery"}

--using http so need to import
require("http")


--every script needs a rule
function portule(host, port)
	return port.number == 80
end

function action(host, port)
	--locvar for response
	local response
	
	response = http.get(host, port, "/cam.jpg")

	--[[ if response.status and response.status ~=404
		and response.header["server"]
		and string.match(response.header["server"], "^thttpd") then
		return "webcam found."
		end

--run: nmap -n -Pn -p 80 --open --script httpcam ip.add.res.- -oN webcam.nmap -d
--flags: -n turn off revnameresolution -Pn and ping scanning -p port --open opnport
--flagcont: -oN filewrite , -d debug for backtrace
end
